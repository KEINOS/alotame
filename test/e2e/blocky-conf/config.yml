upstreams:
  init:
    strategy: fast
  groups:
    default:
      # Primary upstream DNS servers (used only for allowed domains)
      - 1.1.1.1    # Cloudflare
      - 8.8.8.8    # Google
  strategy: parallel_best
  timeout: 2s
  userAgent: "custom UA"

blocking:
  # No denylist is used.
  # When only allowlists are defined, Blocky works in allowlist-only mode
  # and blocks all other domains implicitly.
  denylists: {}

  allowlists:
    allow:
      # External allowlist served via a simple HTTP server
      - http://alotame:5963/allowlist.txt

  # Apply the allowlist-only rule to the default client group
  clientGroupsBlock:
    default:
      - allow

  # Response type for blocked domains (0.0.0.0 / ::)
  blockType: zeroIp
  blockTTL: 1m

  loading:
    # Allowlist refresh interval
    refreshPeriod: 1h
    downloads:
      timeout: 60s
      attempts: 5
      cooldown: 10s
    concurrency: 16
    strategy: failOnError
    maxErrorsPerSource: 5

caching:
  minTime: 5m
  maxTime: 30m
  maxItemsCount: 0
  prefetching: true
  prefetchExpires: 2h
  prefetchThreshold: 5
  prefetchMaxItemsCount: 0
  cacheTimeNegative: 30m

clientLookup:
  # Local router DNS resolver used as a fallback
  upstream: 192.168.0.1
  singleNameOrder:
    - 2
    - 1

# Minimum TLS version for DNS-over-TLS
minTlsServeVersion: 1.3

bootstrapDns:
  # Docker internal DNS server
  - tcp+udp:127.0.0.11
  # Bootstrap DNS servers used before normal resolution is available
  - tcp+udp:1.1.1.1
  - https://1.1.1.1/dns-query

filtering:
  # DNS query types to be processed
  queryTypes:
    - AAAA

fqdnOnly:
  # Require fully qualified domain names
  enable: true

hostsFile:
  sources:
    # Local hosts file sources
    - /etc/hosts
  hostsTTL: 30m
  filterLoopback: true
  loading:
    refreshPeriod: 24h
    downloads:
      timeout: 60s
      attempts: 5
      cooldown: 10s
    concurrency: 16
    strategy: failOnError
    maxErrorsPerSource: 5

ports:
  dns: 53
  tls: 853
  http: 4000

log:
  level: info
  format: text
  timestamp: true
  privacy: false

ede:
  # Enable Extended DNS Errors
  enable: true

specialUseDomains:
  # Handle special-use domains as defined in RFC 6762 Appendix G
  rfc6762-appendixG: true

ecs:
  # Enable EDNS Client Subnet support
  useAsClient: true
  forward: true
